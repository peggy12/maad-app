<!DOCTYPE html>
<html>
<head>
    <title>Test Facebook API</title>
</head>
<body>
    <h1>Facebook API Test</h1>
    <button onclick="testAPI()">Test Facebook API</button>
    <pre id="output"></pre>

    <script>
        // Your current Facebook page credentials
        const PAGE_ID = '61555264737981';
        const ACCESS_TOKEN = 'EAAIFQlajmvcBPgZCdi7UMhXFeAROO1itV5r47w4fhao3pZBHPbMlXAPeQPkC3odrdfdU5RDNWpTK4MkZB79bQPljX5q5ntASEwgOcIBNlmWULaluZAReIKSJRJZAzoi7SZBif6Viqc3Sx1EBa3TFmDMnNPy1lbKZAVID3t0jd681Lnrjg4ReoDL5A1cnEMKZAMAYNV7oBiM7XiHxftLjlhUZBuZCwZCHZC7ghoa55N5w8ux0ZAVZB3vAZDZD';

        async function testAPI() {
            const output = document.getElementById('output');
            output.textContent = 'Testing Facebook API...\n';

            try {
                // Test 1: Verify token
                output.textContent += '\n1. Testing access token...\n';
                const meResponse = await fetch(`https://graph.facebook.com/v20.0/me?access_token=${ACCESS_TOKEN}`);
                const meData = await meResponse.json();
                
                if (meData.error) {
                    output.textContent += `❌ Token Error: ${meData.error.message}\n`;
                    output.textContent += `Error Type: ${meData.error.type}\n`;
                    output.textContent += `Error Code: ${meData.error.code}\n`;
                    return;
                } else {
                    output.textContent += `✅ Token valid! User: ${meData.name || meData.id}\n`;
                }

                // Test 2: Get page info
                output.textContent += '\n2. Testing page access...\n';
                const pageResponse = await fetch(`https://graph.facebook.com/v20.0/${PAGE_ID}?fields=name,id&access_token=${ACCESS_TOKEN}`);
                const pageData = await pageResponse.json();
                
                if (pageData.error) {
                    output.textContent += `❌ Page Error: ${pageData.error.message}\n`;
                } else {
                    output.textContent += `✅ Page found! Name: ${pageData.name}\n`;
                }

                // Test 3: Get page feed
                output.textContent += '\n3. Testing page feed access...\n';
                const feedResponse = await fetch(`https://graph.facebook.com/v20.0/${PAGE_ID}/feed?fields=id,message,created_time&limit=5&access_token=${ACCESS_TOKEN}`);
                const feedData = await feedResponse.json();
                
                if (feedData.error) {
                    output.textContent += `❌ Feed Error: ${feedData.error.message}\n`;
                    output.textContent += `Error Type: ${feedData.error.type}\n`;
                    output.textContent += `Error Code: ${feedData.error.code}\n`;
                    
                    if (feedData.error.code === 190) {
                        output.textContent += '\n⚠️ Token is invalid or expired. Get a new one from Graph API Explorer.\n';
                    } else if (feedData.error.code === 100) {
                        output.textContent += '\n⚠️ Missing permissions. Make sure you selected pages_read_engagement.\n';
                    }
                } else {
                    output.textContent += `✅ Feed access works! Found ${feedData.data?.length || 0} posts\n`;
                    if (feedData.data && feedData.data.length > 0) {
                        output.textContent += '\nRecent posts:\n';
                        feedData.data.forEach((post, i) => {
                            output.textContent += `  ${i+1}. ${post.message?.substring(0, 50) || '(no message)'}...\n`;
                        });
                    } else {
                        output.textContent += '\n⚠️ No posts found. This page might not have any public posts yet.\n';
                    }
                }

            } catch (error) {
                output.textContent += `\n❌ Network Error: ${error.message}\n`;
            }
        }

        // Auto-run test on load
        window.addEventListener('load', testAPI);
    </script>
</body>
</html>
